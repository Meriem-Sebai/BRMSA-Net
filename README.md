# BRMSA-Net: Disclosing concealed colorectal polyps in colonoscopy images via Boundary Recalibration and Multi-Scale Aggregation Network
## 1. Preface 
This repository contains the official Pytorch implementation of our Biomedical Signal Processing and Control paper: [BRMSA-Net: Disclosing concealed colorectal polyps in colonoscopy images via Boundary Recalibration and Multi-Scale Aggregation Network](https://www.sciencedirect.com/science/article/abs/pii/S1746809425005944).
If you have any questions regarding our paper, please donâ€™t hesitate to reach out. If you use **BRMSA-Net** in your research, kindly cite this work (see [Citation](#citation) below).

## 2. Overview
### 2.1. Abstract
For the early detection of colorectal cancer, automated polyp segmentation from colonoscopy images is very crucial. Polyps, often amorphous, exhibit a wide range of sizes and shapes. Furthermore, the boundaries separating polyps from the surrounding mucosal tissues are frequently not distinct. Consequently, segmenting polyps in practical settings is a particularly challenging task. In this study, we propose a Boundary Recalibration and Multi-Scale Aggregation Network (BRMSA-Net) for precise and consistent colon polyp segmentation. In particular, we first introduce the Multi-level Feature Aggregation (MFA) decoder to generate a global segmentation map by fusing high-level features for polyp localization. The MFA decoder incorporates the Criss-cross Feature Fusion (CFF) module, which effectively combines the cross-level features and addresses the issue of semantic gap across different levels. The segmentation map predicted by the MFA decoder is improved by the novel Incremental Boundary Refinement (IBR) module. The IBR module includes the Incremental Scale Fusion (ISF) module, which uses dilated convolutions to extract features with different receptive fields and strategically fuses them to reduce feature disparity. These features are then utilized by the Boundary Recalibration Cross-attention (BRC) module, which gradually refines the polyp boundaries by combining spatial and channel cross-attention. Extensive experiments on public polyp datasets show that BRMSA-Net outperforms several competing approaches in learning and generalization. It achieves 94.02% DSC and 89.46% IoU on CVC-ClinicDB, 92.26% DSC and 87.28% IoU on KvasirSEG, 82.45% DSC and 74.52% IoU on CVC-ColonDB, and 82.28% DSC and 73.81% IoU on ETIS-Larib.

### 2.2. Framework Overview
![BRMSA-Net Architecture](https://drive.google.com/uc?export=view&id=1d7s9o0nyNBBR3zWeIQTNb0H-MZPpPvvR)

### 2.3. Qualitative Results

# 3. Proposed Baseline
### Environment
- Create a virtual environment: `python -m venv BRMSANet`
- Activate the virtual environment: `source BRMSANet/bin/activate`
- Install the requirements: `pip install -r requirements.txt`
### Training
- Download the pretrained weights of MiT-b3 [here](https://drive.google.com/drive/folders/1w59gNxY0z68XnJT4sHOiYM5lgy3tgE7g?usp=sharing).
- Run `sh train.sh` for training. 
### Testing
- Download the trained weights of the BRMSA-Net model [here](https://drive.google.com/drive/folders/1Ytot6mxZWTDwFHymiEp099LbmTVmHYly?usp=sharing).
- Run `sh test.sh` for testing.
### Evaluation
- Use the prediction maps generated by the testing code or download them directly [here](https://drive.google.com/drive/folders/1muYxmzbnZYUF95E49hLXf7H_AYjrCXME?usp=sharing).
- Run `sh eval.sh` for evaluation.

## 4. Citation
If you find this code useful in your research, please consider citing:

```
@article{Sebai2025BRMSANet,
  title     = {BRMSA-Net: Disclosing concealed colorectal polyps in colonoscopy images via Boundary Recalibration and Multi-Scale Aggregation Network},
  author    = {Sebai, Meriem and Goceri, Evgin},
  journal   = {Biomedical Signal Processing and Control},
  volume    = {110},
  pages     = {108083},
  year      = {2025},
  publisher = {Elsevier}
}
```






















